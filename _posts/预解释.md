---
title: 预解释
date: 2016-12-02 18:44:20
type: categories
categories: JavaScript
---

# 什么是预解释？
> 预解释，也叫变量提升，在当前作用域，js代码执行之前，浏览器首先会把带var和带function的进行提前声明或者定义

# 预解释规则：
- 带var的，会提前声明，默认赋值为undefined
```js
console.log(num);//undefined  不会报错
var num=2;
console.log(num);//2
```

- 带function的，会提前声明+定义
```js
fn();//1
function fn(){
    console.log(1);
}
```

预解释只发生在当前作用域中，开始只对window下的进行预解释，只有函数执行的时候，才会对函数中的值进行预解释

注意：声明和定义的区别：
- 声明：var num   告诉浏览器会在全局作用域有一个num的变量了
- 定义：num=value 给变量num进行赋值

# 预解释变态机制
- 预解释不看值。即使等号右边是一个函数也不会把这个函数名字提前声明
```js
console.log(fn);//fn is not defined
var f=function fn(){
    console.log(1);
}
```

- 预解释不理会条件。即使条件是false那么也没关系
```js
console.log(num);//undefined
if(!'num' in window){
    var num=2;
}
```

- 自运行函数的函数名不进行预解释。所以自运行函数一般都是匿名函数
```js
console.log(fn);//报错  fn is not defined
;(function fn(){
    console.log(1);
})();
```

- return后面如果返回的是函数，那么这个返回函数的名字并不会被预解释。而return下面的代码虽然不执行，但是需要进行预解释。如果return后面是一个函数执行，那么先执行然后把执行结果return
```js
function fn(){
    //console.log(fx);//fx is not defined
    return function fx(){
        console.log(num);//undefined
    }
    var num=5;
}
var f=fn();
f();
```

- 在预解释时，如果名字已经声明过了，不需要再重新声明，但是需要重新赋值。如果函数和变量重名，以变量的值为准
```js
console.log(fn);//function fn(){console.log(2);}
function fn(){
    console.log(1);
}
var fn=3;
function fn(){
    console.log(2);
}
console.log(fn);//3
```


